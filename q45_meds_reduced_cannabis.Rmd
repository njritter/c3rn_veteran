---
title: "q45 'What prescription medications are you currently taking for the health conditions and symptoms you face that you are actively trying to reduce the use of by using cannabis? (Please select all that apply)'"
author: "David Ritter"
date: "2/18/2020"
output: html_document
runtime: shiny
---

```{r, message = FALSE}
library(tidyverse)
library(ggplot2)
library(stringr)
source("helper.R")
```

```{r}
raw_data <- read.csv("data/master.csv", stringsAsFactors = FALSE)
```

```{r}
q <- 'What.prescription.medications.are.you.currently.taking.for.the.health.conditions.and.symptoms.you.face.that.you.are.actively.trying.to.reduce.the.use.of.by.using.cannabis...Please.select.all.that.apply.'
q_final_response <- "X.249"
t <- "What prescription medications are you currently taking for the health conditions and symptoms you face that you are actively trying to reduce the use of by using cannabis? (Please select all that apply)"
q_data <- get_choose_all(raw_data, q.name = q, f.response = q_final_response) %>%
  tidy_choose_all()

#q_n <- length(unique(q_data$id))
```

```{r}
q_plot <- clean_choose_all(q_data)
r <- plot_choose_all(q_plot)
r
```

```{r}
ggsave(filename = 'q45_meds_reduced_cannabis.png', plot = r, device = 'png')
write.csv(q_plot, 'q45_meds_reduced_cannabis_144.csv', row.names = FALSE)
write.csv(q_data, 'q45_meds_reduced_cannabis_ids.csv', row.names = FALSE)
```

```{r}
qf_data <- q_data %>%
  filter(chosen == "I donâ€™t take any medications" | chosen == "I'm not trying to reduce any medication use")
```

```{r}
qf_data <- q_data %>%
  filter(chosen != "I donâ€™t take any medications" & chosen != "I'm not trying to reduce any medication use")
```

```{r}
qf_all_data <- 
  qf_data %>%
  inner_join(q_data, by = "id")

qf_n <- length(unique(qf_all_data$id))
```

```{r}
q_plot <- clean_choose_all_f(qf_all_data)
r <- plot_choose_all_f(q_plot)
r
```

```{r}
ggsave(filename = 'q45_meds_reduced_cannabis.png', plot = r, device = 'png')
write.csv(q_plot, 'q45_meds_reduced_cannabis_440.csv', row.names = FALSE)
write.csv(qf_data, 'q45_meds_reduced_cannabis_ids.csv', row.names = FALSE)
```

