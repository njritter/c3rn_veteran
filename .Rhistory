# Read in raw data from the Veterans surveys. These are the files downloaded from survey monkey saved as a .csv
raw_data_general <- read.csv("data/general.csv", stringsAsFactors = FALSE)
raw_data_botanist <- read.csv("data/botanist.csv", stringsAsFactors = FALSE)
raw_data_bask <- read.csv("data/bask.csv", stringsAsFactors = FALSE)
raw_data_hr <- read.csv("data/hr.csv", stringsAsFactors = FALSE)
# Pull out all responses for q98 (a single selection question) combine, then determine 'question n' (subsequent q are labeled for convenience, do not respond to survey q#)
q98 <- "What.state.in.the.US.do.you.currently.live.in."
q99 <- "What.US.State.do.you.currently.live.in."
q100 <- "Which.US.state.do.you.currently.live.in."
q101 <- "What.US.state.do.you.currently.live.in."
q98_general <- get_single_selection(data = raw_data_general, q.name = q98)
q98_bask <- get_single_selection(data = raw_data_bask, q.name = q99)
q98_botanist <- get_single_selection(data = raw_data_botanist, q.name = q100)
q98_hr <- get_single_selection(data = raw_data_hr, q.name = q101)
q98_all <- rbind(q98_general, q98_bask, q98_botanist, q98_hr)
ma_ids <- q98_all %>%
filter(response %in% c("Massachusetts"))
state_ma <- length(unique(ma_ids$id))
# Pull out all responses for q33 (a single selection question) combine, then determine 'question n'
q33 <- "On.average..how.much.do.you.pay..in.US.dollars..for.your.medications.on.a.monthly.basis.out.of.pocket."
q33_general <- get_single_selection(data = raw_data_general, q.name = q33)
q33_bask <- get_single_selection(data = raw_data_bask, q.name = q33)
q33_botanist <- get_single_selection(data = raw_data_botanist, q.name = q33)
q33_hr <- get_single_selection(data = raw_data_hr, q.name = q33)
q33_all <- rbind(q33_general, q33_bask, q33_botanist, q33_hr) %>%
inner_join(ma_ids, by = "id")
q33_m_n <- length(unique(q33_all$id))
histogram_object <- hist(as.numeric(all_data$response))
histogram_object$breaks = c(0, 200, 400, 600, 800, 1000, 1200, 1400)
histogram_object$counts
plot(histogram_object)
# Save all question data including response IDs as csv (save question n and N at end of file as "_x.x")
write.csv(q33_all, 'q33_cannabis_cost_89.csv', row.names = FALSE)
# Save all question data including response IDs as csv (save question n and N at end of file as "_x.x")
write.csv(q33_all, 'q33_med_cost_monthly_89.csv', row.names = FALSE)
# Pull out all responses for q38 (a choose all question), combine, turn into a tidy data format for further processing then determine 'question n'
q38 <- "Which.health.conditions.do.you.find.cannabis.to.be.helpful.in.treating...Please.select.all.that.apply."
q38_final_response <- "X.179"
q38_general <- get_choose_all(raw_data_general, q.name = q38, f.response = q38_final_response)
q38_bask <- get_choose_all(raw_data_bask, q.name = q38, f.response = q38_final_response)
q38_botanist <- get_choose_all(raw_data_botanist, q.name = q38, f.response = q38_final_response)
q38_hr <- get_choose_all(raw_data_hr, q.name = q38, f.response = q38_final_response)
q38_all <-
rbind(q38_general, q38_bask, q38_botanist, q38_hr) %>%
tidy_choose_all() %>%
inner_join(ma_ids, by = "id")
q38_m_n <- length(unique(q38_all$id))
# Manipulate data into a graphable format
q38_plot <-
q38_all %>%
group_by(chosen) %>%
summarize(count = n()) %>%
mutate(percent_all = count / sum(count)) %>%
mutate(percent_responded = count / q38_m_n)
# Plot with percents and response counts
r <-
ggplot(q38_plot, aes(x = reorder(chosen, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded,2), count, sep = "***")))
r
# Save graph as PNG, plot data as csv, and all question data including response IDs as csv (save question n and N at end of plot file as "_x.x")
ggsave(filename = 'q38_conditions_cannabis.png', plot = r, device = 'png')
write.csv(q38_plot, 'q38_conditions_cannabis_161.csv', row.names = FALSE)
write.csv(q38_all, 'q38_conditions_cannabis_ids.csv', row.names = FALSE)
# Load libraries
library(tidyverse)
library(ggplot2)
library(stringr)
source("helper.R")
# Pull out all responses for q39 (a single selection question) combine, then determine 'question n'
q39 <- "What.is.the.primary.health.condition.for.which.you.find.cannabis.to.be.helpful...Please.select.one."
q39_general <- get_single_selection(data = raw_data_general, q.name = q39)
q39_bask <- get_single_selection(data = raw_data_bask, q.name = q39)
q39_botanist <- get_single_selection(data = raw_data_botanist, q.name = q39)
q39_hr <- get_single_selection(data = raw_data_hr, q.name = q39)
q39_all <- rbind(q39_general, q39_bask, q39_botanist, q39_hr) %>%
inner_join(ma_ids, by = "id")
q39_m_n <- length(unique(q39_all$id))
# Manipulate data into a graphable format
q39_plot <-
q39_all %>%
group_by(response.x) %>%
summarize(count = n()) %>%
mutate(percent_all = count / sum(count)) %>%
mutate(percent_responded = count / q39_m_n)
# Plot with percents and response counts
r <-
ggplot(q39_plot, aes(x = reorder(response.x, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded, 2), count, sep = "***")))
r
# Plot with percents and response counts
r <-
ggplot(q39_plot, aes(x = reorder(response.x, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded, 2), count, sep = "***")))
r
# Save graph as PNG, plot data as csv, and all question data including response IDs as csv (save question n and N at end of plot file as "_x.x")
ggsave(filename = 'q39_top_condition_cannabis.png', plot = r, device = 'png')
write.csv(q39_plot, 'q39_top_condition_cannabis_161.csv', row.names = FALSE)
write.csv(q39_all, 'q39_top_condition_cannabis_ids.csv', row.names = FALSE)
# Pull out all responses for q43 (a single selection question) combine, then determine 'question n'
q43 <- "How.do.you.feel.cannabis.has.helped.your.daily.life.Thinking.about.how.you.feel.TODAY.compared.to.the.BEGINNING.of.your.use.of.cannabis.to.treat.your.primary.medical.condition..."
q44 <- "How.do.you.feel.cannabis.has.helped.your.daily.life.Thinking.about.how.you.feelÂ.TODAYÂ.compared.to.theÂ.BEGINNINGÂ.of.your.use.of.cannabis.to.treat.your.primary.medical.condition..."
q43_general <- get_single_selection(data = raw_data_general, q.name = q43)
q43_bask <- get_single_selection(data = raw_data_bask, q.name = q43)
q43_botanist <- get_single_selection(data = raw_data_botanist, q.name = q43)
q43_hr <- get_single_selection(data = raw_data_hr, q.name = q44)
q43_all <- rbind(q43_general, q43_bask, q43_botanist, q43_hr) %>%
inner_join(ma_ids, by = "id")
q43_m_n <- length(unique(q43_all$id))
# Manipulate data into a graphable format
q43_plot <-
q43_all %>%
group_by(response.x) %>%
summarize(count = n()) %>%
mutate(percent_all = count / sum(count)) %>%
mutate(percent_responded = count / q43_m_n)
# Plot with percents and response counts
r <-
ggplot(q43_plot, aes(x = reorder(response.x, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded, 2), count, sep = "***")))
r
# Save graph as PNG, plot data as csv, and all question data including response IDs as csv (save question n and N at end of plot file as "_x.x")
ggsave(filename = 'q43_cannabis_daily_qol.png', plot = r, device = 'png')
write.csv(q43_plot, 'q43_cannabis_daily_qol_160.csv', row.names = FALSE)
write.csv(q43_all, 'q43_cannabis_daily_qol_ids.csv', row.names = FALSE)
# Pull out all responses for q53 (a single selection question) combine, then determine 'question n'
q53 <- "On.average..how.much.do.you.spend..in.US.dollars..on.consumable.cannabis.products.per.week."
q53_general <- get_single_selection(data = raw_data_general, q.name = q53)
q53_bask <- get_single_selection(data = raw_data_bask, q.name = q53)
q53_botanist <- get_single_selection(data = raw_data_botanist, q.name = q53)
q53_hr <- get_single_selection(data = raw_data_hr, q.name = q53)
q53_all <- rbind(q53_general, q53_bask, q53_botanist, q53_hr) %>%
inner_join(ma_ids, by = "id")
q53_m_n <- length(unique(q53_all$id))
histogram_object <- hist(as.numeric(all_data$response))
histogram_object$breaks = c(0, 100, 200, 300, 400, 500, 600)
histogram_object$counts
plot(histogram_object)
write.csv(q53_all, 'vet_q53_cannabis_cost_weekly_149.csv', row.names = FALSE)
# Pull out all responses for q48 (a single selection question) combine, then determine 'question n'
q48 <- "What.is.your.top.preferred.method..that.is..favorite.method..of.using.cannabis...Please.select.one."
q48_general <- get_single_selection(data = raw_data_general, q.name = q48)
q48_bask <- get_single_selection(data = raw_data_bask, q.name = q48)
q48_botanist <- get_single_selection(data = raw_data_botanist, q.name = q48)
q48_hr <- get_single_selection(data = raw_data_hr, q.name = q48)
q48_all <- rbind(q48_general, q48_bask, q48_botanist, q48_hr) %>%
inner_join(ma_ids, by = "id")
q48_m_n <- length(unique(q48_all$id))
# Manipulate data into a graphable format
q48_plot <-
q48_all %>%
group_by(response.x) %>%
summarize(count = n()) %>%
mutate(percent_all = count / sum(count)) %>%
mutate(percent_responded = count / q48_m_n)
# Plot with percents and response counts
r <-
ggplot(q48_plot, aes(x = reorder(response.x, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded, 2), count, sep = "***")))
r
# Save graph as PNG, plot data as csv, and all question data including response IDs as csv (save question n and N at end of plot file as "_x.x")
ggsave(filename = 'q48_top_cannabis_method.png', plot = r, device = 'png')
write.csv(q48_plot, 'q48_top_cannabis_method_161.csv', row.names = FALSE)
write.csv(q48_all, 'q48_top_cannabis_method_ids.csv', row.names = FALSE)
# Pull out all responses for q61 (a choose all question), combine, turn into a tidy data format for further processing then determine 'question n'
q61 <- "Do.you.face.any.of.the.following.barriers.for.you.to.consume.cannabis...Please.select.all.that.apply."
q61_final_response <- "X.279"
q61_general <- get_choose_all(raw_data_general, q.name = q61, f.response = q61_final_response)
q61_botanist <- get_choose_all(raw_data_botanist, q.name = q61, f.response = q61_final_response)
q61_hr <- get_choose_all(raw_data_hr, q.name = q61, f.response = q61_final_response)
q61_bask <- get_choose_all(raw_data_bask, q.name = q61, f.response = q61_final_response)
q61_all <-
rbind(q61_bask, q61_general, q61_botanist, q61_hr) %>%
tidy_choose_all() %>%
inner_join(ma_ids, by = "id")
q61_m_n <- length(unique(q61_all$id))
# Manipulate data into a graphable format
q61_plot <-
q61_all %>%
group_by(chosen) %>%
summarize(count = n()) %>%
mutate(percent_all = count / sum(count)) %>%
mutate(percent_responded = count / q61_m_n)
# Plot with percents and response counts
r <-
ggplot(q61_plot, aes(x = reorder(chosen, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded,2), count, sep = "***")))
r
# Save graph as PNG, plot data as csv, and all question data including response IDs as csv (save question n and N at end of plot file as "_x.x")
ggsave(filename = 'q61_barriers.png', plot = r, device = 'png')
write.csv(q61_plot, 'q61_barriers_161.csv', row.names = FALSE)
write.csv(q61_all, 'q61_barrers_ids.csv', row.names = FALSE)
# Pull out all responses for q77 (a choose all question), combine, turn into a tidy data format for further processing then determine 'question n'
q77 <- "What.war.s..did.you.serve.in...Please.select.all.that.apply."
q77_general_final_response <- "X.373"
q77_bask_final_response <- "X.1612"
q77_botanist_final_response <- "X.2772"
q77_hr_final_response <- "X.945"
q77_general <- get_choose_all(raw_data_general, q.name = q77, f.response = q77_general_final_response)
q77_bask <- get_choose_all(raw_data_bask, q.name = q77, f.response = q77_bask_final_response)
q77_botanist <- get_choose_all(raw_data_botanist, q.name = q77, f.response = q77_botanist_final_response)
q77_hr <- get_choose_all(data = raw_data_hr, q.name = q77, f.response = q77_hr_final_response)
q77_all <-
rbind(q77_general, q77_bask, q77_botanist, q77_hr) %>%
tidy_choose_all() %>%
inner_join(ma_ids, by = "id")
q77_m_n <- length(unique(q77_all$id))
# Manipulate data into a graphable format
q77_plot <-
q77_all %>%
group_by(chosen) %>%
summarize(count = n()) %>%
mutate(percent_all = count / sum(count)) %>%
mutate(percent_responded = count / q77_m_n)
# Plot with percents and response counts
r <-
ggplot(q77_plot, aes(x = reorder(chosen, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded,2), count, sep = "***")))
r
# Save graph as PNG, plot data as csv, and all question data including response IDs as csv (save question n and N at end of plot file as "_x.x")
ggsave(filename = 'q77_wars_served.png', plot = r, device = 'png')
write.csv(q77_plot, 'q77_wars_served_161.csv', row.names = FALSE)
write.csv(q77_all, 'q77_wars_served_ids.csv', row.names = FALSE)
# Pull out all responses for q90 (a single selection question) and combine
q90 <- "What.is.your.annual.household.income..in.US.dollars."
q90_general <- get_single_selection(data = raw_data_general, q.name = q90)
q90_bask <- get_single_selection(data = raw_data_bask, q.name = q90)
q90_botanist <- get_single_selection(data = raw_data_botanist, q.name = q90)
q90_hr <- get_single_selection(data = raw_data_hr, q.name = q90)
q90_data <- rbind(q90_general, q90_bask, q90_botanist, q90_hr) %>%
inner_join(ma_ids, by = "id")
q90_m_n <- length(unique(all_data$id))
# Pull out all responses for q90 (a single selection question) and combine
q90 <- "What.is.your.annual.household.income..in.US.dollars."
q90_general <- get_single_selection(data = raw_data_general, q.name = q90)
q90_bask <- get_single_selection(data = raw_data_bask, q.name = q90)
q90_botanist <- get_single_selection(data = raw_data_botanist, q.name = q90)
q90_hr <- get_single_selection(data = raw_data_hr, q.name = q90)
q90_data <- rbind(q90_general, q90_bask, q90_botanist, q90_hr) %>%
inner_join(ma_ids, by = "id")
q90_m_n <- length(unique(q90_data$id))
# Pull out all responses for q90 (a single selection question) and combine
q90 <- "What.is.your.annual.household.income..in.US.dollars."
q90_general <- get_single_selection(data = raw_data_general, q.name = q90)
q90_bask <- get_single_selection(data = raw_data_bask, q.name = q90)
q90_botanist <- get_single_selection(data = raw_data_botanist, q.name = q90)
q90_hr <- get_single_selection(data = raw_data_hr, q.name = q90)
q90_all <- rbind(q90_general, q90_bask, q90_botanist, q90_hr) %>%
inner_join(ma_ids, by = "id")
q90_m_n <- length(unique(q90_all$id))
# Manipulate data into a graphable format
q90_plot <-
q90_data %>%
group_by(response) %>%
summarize(count = n()) %>%
mutate(percent_all = count / sum(count)) %>%
mutate(percent_responded = count / q90_m_n)
# Manipulate data into a graphable format
q90_plot <-
q90_data %>%
group_by(response.x) %>%
summarize(count = n()) %>%
mutate(percent_all = count / sum(count)) %>%
mutate(percent_responded = count / q90_m_n)
# Plot with percents and response counts
r <-
ggplot(q90_plot, aes(x = reorder(response.x, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded, 2), count, sep = "***")))
r
View(q33_all)
View(q90_all)
# Pull out all responses for q100 (a single selection question) combine, then determine 'question n'
q100 <- "I.would.choose.medical.cannabis.if.it.was.a.federally.legal.treatment.option."
q100_general <- get_single_selection(data = raw_data_general, q.name = q100)
q100_bask <- get_single_selection(data = raw_data_bask, q.name = q100)
q100_botanist <- get_single_selection(data = raw_data_botanist, q.name = q100)
q100_hr <- get_single_selection(data = raw_data_hr, q.name = q100)
q100_all <- rbind(q100_general, q100_bask, q100_botanist, q100_hr)
q100_m_n <- length(unique(q100_all$id))
# Manipulate data into a graphable format
q100_plot <-
q100_all %>%
group_by(response.x) %>%
summarize(count = n()) %>%
mutate(percent_all = count / sum(count)) %>%
mutate(percent_responded = count / q100_m_n)
# Manipulate data into a graphable format
q100_plot <-
q100_all %>%
group_by(response) %>%
summarize(count = n()) %>%
mutate(percent_all = count / sum(count)) %>%
mutate(percent_responded = count / q100_m_n)
# Plot with percents and response counts
r <-
ggplot(q100_plot, aes(x = reorder(response, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded, 2), count, sep = "***")))
r
# Pull out all responses for q100 (a single selection question) combine, then determine 'question n'
q100 <- "I.would.choose.medical.cannabis.if.it.was.a.federally.legal.treatment.option."
q100_general <- get_single_selection(data = raw_data_general, q.name = q100)
q100_bask <- get_single_selection(data = raw_data_bask, q.name = q100)
q100_botanist <- get_single_selection(data = raw_data_botanist, q.name = q100)
q100_hr <- get_single_selection(data = raw_data_hr, q.name = q100)
q100_all <- rbind(q100_general, q100_bask, q100_botanist, q100_hr)
q100_m_n <- length(unique(q100_all$id))
# Manipulate data into a graphable format
q100_plot <-
q100_all %>%
group_by(response) %>%
summarize(count = n()) %>%
mutate(percent_all = count / sum(count)) %>%
mutate(percent_responded = count / q100_m_n)
# Pull out all responses for q100 (a single selection question) combine, then determine 'question n'
q100 <- "I.would.choose.medical.cannabis.if.it.was.a.federally.legal.treatment.option."
q100_general <- get_single_selection(data = raw_data_general, q.name = q100)
q100_bask <- get_single_selection(data = raw_data_bask, q.name = q100)
q100_botanist <- get_single_selection(data = raw_data_botanist, q.name = q100)
q100_hr <- get_single_selection(data = raw_data_hr, q.name = q100)
q100_all <- rbind(q100_general, q100_bask, q100_botanist, q100_hr) %>%
inner_join(ma_ids, by = "id")
q100_m_n <- length(unique(q100_all$id))
# Manipulate data into a graphable format
q100_plot <-
q100_all %>%
group_by(response.x) %>%
summarize(count = n()) %>%
mutate(percent_all = count / sum(count)) %>%
mutate(percent_responded = count / q100_m_n)
# Plot with percents and response counts
r <-
ggplot(q100_plot, aes(x = reorder(response.x, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded, 2), count, sep = "***")))
r
# Save graph as PNG, plot data as csv, and all question data including response IDs as csv (save question n and N at end of plot file as "_x.x")
ggsave(filename = 'q100_vet_med_cannabis_research.png', plot = r, device = 'png')
write.csv(q100_plot, 'q100_vet_med_cannabis_research_161.csv', row.names = FALSE)
write.csv(q100_all, 'q100_vet_med_cannabis_research_ids.csv', row.names = FALSE)
# Pull out all responses for q77 (a choose all question), combine, turn into a tidy data format for further processing then determine 'question n'
q77 <- "What.war.s..did.you.serve.in...Please.select.all.that.apply."
q77_general_f <- "X.373"
q77_botanist_f <- "X.2772"
q77_bask_f <- "X.1612"
q77_hr_f <- "X.945"
q77_general <- get_choose_all(raw_data_general, q.name = q77, f.response = q77_general_f)
q77_bask <- get_choose_all(raw_data_bask, q.name = q77, f.response = q77_bask_f)
q77_botanist <- get_choose_all(raw_data_botanist, q.name = q77, f.response = q77_botanist_f)
q77_hr <- get_choose_all(raw_data_hr, q.name = q77, f.response = q77_hr_f)
q77_all <- rbind(q77_general, q77_bask, q77_botanist, q77_hr) %>%
tidy_choose_all() %>%
inner_join(ma_ids, by = "id")
q77_m_n <- length(unique(q77_all$id))
# Pull out all responses for q77 (a choose all question), combine, turn into a tidy data format for further processing then determine 'question n'
q77 <- "What.war.s..did.you.serve.in...Please.select.all.that.apply."
q77_general_f <- "X.373"
q77_botanist_f <- "X.2772"
q77_bask_f <- "X.1612"
q77_hr_f <- "X.945"
q77_general <- get_choose_all(raw_data_general, q.name = q77, f.response = q77_general_f)
q77_bask <- get_choose_all(raw_data_bask, q.name = q77, f.response = q77_bask_f)
q77_botanist <- get_choose_all(raw_data_botanist, q.name = q77, f.response = q77_botanist_f)
q77_hr <- get_choose_all(raw_data_hr, q.name = q77, f.response = q77_hr_f)
q77_all <- rbind(q77_general, q77_bask, q77_botanist, q77_hr) %>%
tidy_choose_all() %>%
inner_join(ma_ids, by = "id")
q77_m_n <- length(unique(q77_all$id))
# Pull out all responses for q77 (a choose all question), combine, turn into a tidy data format for further processing then determine 'question n'
q77 <- "What.war.s..did.you.serve.in...Please.select.all.that.apply."
q77_general_f <- "X.373"
q77_botanist_f <- "X.2772"
q77_bask_f <- "X.1612"
q77_hr_f <- "X.945"
q77_general <- get_choose_all(raw_data_general, q.name = q77, f.response = q77_general_f)
q77_bask <- get_choose_all(raw_data_bask, q.name = q77, f.response = q77_bask_f)
q77_botanist <- get_choose_all(raw_data_botanist, q.name = q77, f.response = q77_botanist_f)
q77_hr <- get_choose_all(raw_data_hr, q.name = q77, f.response = q77_hr_f)
q77_all <- rbind(q77_general, q77_bask, q77_botanist, q77_hr) %>%
tidy_choose_all()
q77_m_n <- length(unique(q77_all$id))
# Load libraries
library(tidyverse)
library(ggplot2)
library(stringr)
source("helper.R")
# Read in raw data from the Veterans surveys. These are the files downloaded from survey monkey saved as a .csv
raw_data_general <- read.csv("data/general.csv", stringsAsFactors = FALSE)
raw_data_botanist <- read.csv("data/botanist.csv", stringsAsFactors = FALSE)
raw_data_bask <- read.csv("data/bask.csv", stringsAsFactors = FALSE)
raw_data_hr <- read.csv("data/hr.csv", stringsAsFactors = FALSE)
# Pull out all responses for q98 (a single selection question) combine, then determine 'question n' (subsequent q are labeled for convenience, do not respond to survey q#)
q98 <- "What.state.in.the.US.do.you.currently.live.in."
q99 <- "What.US.State.do.you.currently.live.in."
q100 <- "Which.US.state.do.you.currently.live.in."
q101 <- "What.US.state.do.you.currently.live.in."
q98_general <- get_single_selection(data = raw_data_general, q.name = q98)
q98_bask <- get_single_selection(data = raw_data_bask, q.name = q99)
q98_botanist <- get_single_selection(data = raw_data_botanist, q.name = q100)
q98_hr <- get_single_selection(data = raw_data_hr, q.name = q101)
q98_all <- rbind(q98_general, q98_bask, q98_botanist, q98_hr)
ma_ids <- q98_all %>%
filter(response %in% c("Massachusetts"))
state_ma <- length(unique(ma_ids$id))
# Pull out all responses for q77 (a choose all question), combine, turn into a tidy data format for further processing then determine 'question n'
q77 <- "What.war.s..did.you.serve.in...Please.select.all.that.apply."
q77_general_f <- "X.373"
q77_botanist_f <- "X.2772"
q77_bask_f <- "X.1612"
q77_hr_f <- "X.945"
q77_general <- get_choose_all(raw_data_general, q.name = q77, f.response = q77_general_f)
q77_bask <- get_choose_all(raw_data_bask, q.name = q77, f.response = q77_bask_f)
q77_botanist <- get_choose_all(raw_data_botanist, q.name = q77, f.response = q77_botanist_f)
q77_hr <- get_choose_all(raw_data_hr, q.name = q77, f.response = q77_hr_f)
q77_all <- rbind(q77_general, q77_bask, q77_botanist, q77_hr) %>%
tidy_choose_all() %>%
inner_join(ma_ids, by = "id")
q77_m_n <- length(unique(q77_all$id))
# Manipulate data into a graphable format
q77_plot <-
q77_all %>%
group_by(chosen) %>%
summarize(count = n()) %>%
mutate(percent_all = count / sum(count)) %>%
mutate(percent_responded = count / q77_m_n)
# Plot with percents and response counts
r <-
ggplot(q77_plot, aes(x = reorder(chosen, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded,2), count, sep = "***")))
r
# Save graph as PNG, plot data as csv, and all question data including response IDs as csv (save question n and N at end of plot file as "_x.x")
ggsave(filename = 'q_wars_served.png', plot = r, device = 'png')
write.csv(q77_plot, 'q_wars_served_161.csv', row.names = FALSE)
write.csv(q77_all, 'q_wars_served_ids.csv', row.names = FALSE)
# Pull out all responses for q88 (a single selection question), combine, then determine 'question n'
q88 <- "What.is.your.age..in.years.."
q88_general <- get_single_selection(data = raw_data_general, q.name = q88)
q88_bask <- get_single_selection(data = raw_data_bask, q.name = q88)
q88_botanist <- get_single_selection(data = raw_data_botanist, q.name = q88)
q88_hr <- get_single_selection(data = raw_data_hr, q.name = q88)
q88_all <- rbind(q88_general, q88_bask, q88_botanist, q88_hr)
number_of_people <- length(unique(q88_all$id))
# Load libraries
library(tidyverse)
library(ggplot2)
library(stringr)
source("helper.R")
# Read in raw data from the Veterans surveys. These are the files downloaded from survey monkey saved as a .csv
raw_data_general <- read.csv("data/general.csv", stringsAsFactors = FALSE)
raw_data_botanist <- read.csv("data/botanist.csv", stringsAsFactors = FALSE)
raw_data_bask <- read.csv("data/bask.csv", stringsAsFactors = FALSE)
raw_data_hr <- read.csv("data/hr.csv", stringsAsFactors = FALSE)
# Pull out all responses for q88 (a single selection question), combine, then determine 'question n'
q88 <- "What.is.your.age..in.years.."
q88_general <- get_single_selection(data = raw_data_general, q.name = q88)
q88_bask <- get_single_selection(data = raw_data_bask, q.name = q88)
q88_botanist <- get_single_selection(data = raw_data_botanist, q.name = q88)
q88_hr <- get_single_selection(data = raw_data_hr, q.name = q88)
q88_all <- rbind(q88_general, q88_bask, q88_botanist, q88_hr)
q88_m_n <- length(unique(q88_all$id))
# Pull out all responses for q88 (a single selection question), combine, then determine 'question n'
q88 <- "What.is.your.age..in.years.."
q88_general <- get_single_selection(data = raw_data_general, q.name = q88)
q88_bask <- get_single_selection(data = raw_data_bask, q.name = q88)
q88_botanist <- get_single_selection(data = raw_data_botanist, q.name = q88)
q88_hr <- get_single_selection(data = raw_data_hr, q.name = q88)
q88_all <- rbind(q88_general, q88_bask, q88_botanist, q88_hr) %>%
inner_join(ma_ids, by = "id")
q88_m_n <- length(unique(q88_all$id))
# Manipulate data into a graphable format
q88_plot <-
test %>%
group_by(response.x, ) %>%
summarize(count = n()) %>%
ungroup() %>%
mutate(percent_all = count / sum(count))
# Manipulate data into a graphable format
q88_plot <-
q88_all %>%
group_by(response.x, ) %>%
summarize(count = n()) %>%
ungroup() %>%
mutate(percent_all = count / sum(count))
# Plot with percents and response counts
r <-
ggplot(q88_plot, aes(x = response.x, y = count)) +
geom_bar(stat = 'identity') +
geom_text(aes(label= paste(round(percent_all,2), count, sep = "***")))
r
# Save graph as PNG, plot data as csv, and all question data including response IDs as csv (save question n and N at end of plot file as "_x.x")
ggsave(filename = 'q88_age.png', plot = r, device = 'png')
write.csv(q88_plot, 'q88_age_161.csv', row.names = FALSE)
write.csv(test, 'q88_age_ids.csv', row.names = FALSE)
