source("helper0.R")
raw_data <- read.csv("data/master.csv", stringsAsFactors = FALSE)
q <- "If.you.had.to.live.with.some.pain..what.level.of.pain.would.be.acceptable."
q_data <- get_single_selection(data = raw_data, q.name = q)
q_n <- length(unique(q_data$id))
# Manipulate data into a graphable format
q_plot <-
q_data %>%
group_by(response) %>%
summarize(count = n()) %>%
mutate(percent_responded = round(100*(count / q_n), 2)) %>%
arrange(desc(count))
# Plot with percents and response counts
r <-
ggplot(q_plot, aes(x = reorder(response, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded, 0), count, sep = "%:"))) +
xlab("Response") +
ylab("% Responded, Count") +
labs(title = "If you had to live with some pain, what level of pain would be acceptable?", subtitle = q_n)
r
# Save graph as PNG, plot data as csv, and all question data including response IDs as csv (save question n and N at end of plot file as "_x.x")
ggsave(filename = 'q12_acceptable_pain.png', plot = r, device = 'png')
write.csv(q12_plot, 'q12_acceptable_pain_217.csv', row.names = FALSE)
write.csv(q12_all, 'q12_acceptable_pain_ids.csv', row.names = FALSE)
# Save graph as PNG, plot data as csv, and all question data including response IDs as csv (save question n and N at end of plot file as "_x.x")
ggsave(filename = 'q12_acceptable_pain.png', plot = r, device = 'png')
write.csv(q_plot, 'q12_acceptable_pain_217.csv', row.names = FALSE)
write.csv(q_data, 'q12_acceptable_pain_ids.csv', row.names = FALSE)
# Load libraries
library(tidyverse)
library(ggplot2)
library(stringr)
source("helper.R")
# Read in raw data from the Veterans surveys. These are the files downloaded from survey monkey saved as a .csv
raw_data <- read.csv("data/master.csv", stringsAsFactors = FALSE)
# Pull out all responses for q5 (a choose all question), combine, turn into a tidy data format for further processing then d <- tidy_choose_all(q)etermine 'question n'
q <- 'Where.are.the.locations.of.your.pain..please.check.all.that.apply.'
q_final_response <- "X.66"
q_data <- get_choose_all(raw_data, q.name = q, f.response = q_final_response) %>%
tidy_choose_all()
q_n <- length(unique(q_data$id))
# Manipulate data into a graphable format
q_plot <-
q_data %>%
group_by(chosen) %>%
summarize(count = n()) %>%
mutate(percent_responded = round(100*(count / q_n), 2)) %>%
arrange(desc(count))
# Plot with percents and response counts
r <-
ggplot(q_plot, aes(x = reorder(chosen, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded, 0), count, sep = "%:"))) +
xlab("Response") +
ylab("% Responded, Count") +
labs(title = "Where are the locations of your pain (please check all that apply)", subtitle = q_n)
r
# Save graph as PNG, plot data as csv, and all question data including response IDs as csv (save question n and N at end of plot file as "_x.x")
ggsave(filename = 'q13_pain_locations.png', plot = r, device = 'png')
write.csv(q_plot, 'q13_pain_locations_217.csv', row.names = FALSE)
write.csv(q_data, 'q13_pain_locations_ids.csv', row.names = FALSE)
# Load libraries
library(tidyverse)
library(ggplot2)
library(stringr)
source("helper.R")
# Read in raw data from the Veterans surveys. These are the files downloaded from survey monkey saved as a .csv
raw_data <- read.csv("data/master.csv", stringsAsFactors = FALSE)
# Pull out all responses for q5 (a choose all question), combine, turn into a tidy data format for further processing then d <- tidy_choose_all(q)etermine 'question n'
q <- 'What.are.the.effects.of.your.pain...Please.select.all.that.apply.'
q_final_response <- "X.81"
q_data <- get_choose_all(raw_data, q.name = q, f.response = q_final_response) %>%
tidy_choose_all()
q_n <- length(unique(q_data$id))
# Manipulate data into a graphable format
q_plot <-
q_data %>%
group_by(chosen) %>%
summarize(count = n()) %>%
mutate(percent_responded = round(100*(count / q_n), 2)) %>%
arrange(desc(count))
# Manipulate data into a graphable format
q_plot <-
q_data %>%
group_by(chosen) %>%
summarize(count = n()) %>%
mutate(percent_responded = round(100*(count / q_n), 2)) %>%
arrange(desc(count))
# Plot with percents and response counts
r <-
ggplot(q_plot, aes(x = reorder(chosen, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded, 0), count, sep = "%:"))) +
xlab("Response") +
ylab("% Responded, Count") +
labs(title = "What are the effects of your pain? (Please select all that apply)", subtitle = q_n)
r
# Plot with percents and response counts
r <-
ggplot(q_plot, aes(x = reorder(chosen, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded, 0), count, sep = "%:"))) +
xlab("Response") +
ylab("% Responded, Count") +
labs(title = "What are the effects of your pain? (Please select all that apply)", subtitle = q_n)
r
# Save graph as PNG, plot data as csv, and all question data including response IDs as csv (save question n and N at end of plot file as "_x.x")
ggsave(filename = 'q14_pain_effects.png', plot = r, device = 'png')
write.csv(q_plot, 'q14_pain_effects_217.csv', row.names = FALSE)
write.csv(q_data, 'q14_pain_effects_ids.csv', row.names = FALSE)
# Pull out all responses for q5 (a choose all question), combine, turn into a tidy data format for further processing then d <- tidy_choose_all(q)etermine 'question n'
q <- 'Which.of.the.following.health.conditions.do.you.face.and.or.have.been.diagnosed.with...Please.select.all.that.apply.'
q_final_response <- "X.25"
q_data <- get_choose_all(raw_data, q.name = q, f.response = q_final_response) %>%
tidy_choose_all()
q_n <- length(unique(q_data$id))
# Pull out all responses for q5 (a choose all question), combine, turn into a tidy data format for further processing then d <- tidy_choose_all(q)etermine 'question n'
q <- 'What.types.of.prescription.medications.are.you.currently.taking.for.the.health.conditions.and.symptoms.you.face...Please.select.all.that.apply.'
q_final_response <- "X.136"
q_data <- get_choose_all(raw_data, q.name = q, f.response = q_final_response) %>%
tidy_choose_all()
q_n <- length(unique(q_data$id))
# Manipulate data into a graphable format
q_plot <-
q_data %>%
group_by(chosen) %>%
summarize(count = n()) %>%
mutate(percent_responded = round(100*(count / q_n), 2)) %>%
arrange(desc(count))
# Plot with percents and response counts
r <-
ggplot(q_plot, aes(x = reorder(chosen, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded, 0), count, sep = "%:"))) +
xlab("Response") +
ylab("% Responded, Count") +
labs(title = "Which of the following health conditions do you face and or have been diagnosed with... Please select all that apply", subtitle = q_n)
r
# Save graph as PNG, plot data as csv, and all question data including response IDs as csv (save question n and N at end of plot file as "_x.x")
ggsave(filename = 'q20_prescriptions.png', plot = r, device = 'png')
write.csv(q_plot, 'q20_prescriptions_217.csv', row.names = FALSE)
write.csv(q_data, 'q20_prescriptions_ids.csv', row.names = FALSE)
# Load libraries
library(tidyverse)
library(ggplot2)
library(stringr)
source("helper0.R")
# Read in raw data from the Veterans surveys. These are the files downloaded from survey monkey saved as a .csv
raw_data_general <- read.csv("data/general.csv", stringsAsFactors = FALSE)
raw_data_botanist <- read.csv("data/botanist.csv", stringsAsFactors = FALSE)
raw_data_bask <- read.csv("data/bask.csv", stringsAsFactors = FALSE)
raw_data_hr <- read.csv("data/hr.csv", stringsAsFactors = FALSE)
# Pull out all responses for q21 (a single selection question) combine, then determine 'question n'
q21 <- "How.many.total.prescription.medications.are.you.currently.taking...Please.insert.number."
q21_general <- get_single_selection(data = raw_data_general, q.name = q21)
q21_bask <- get_single_selection(data = raw_data_bask, q.name = q21)
q21_botanist <- get_single_selection(data = raw_data_botanist, q.name = q21)
q21_hr <- get_single_selection(raw_data_hr, q.name = q21)
q21_all <- rbind(q21_general, q21_bask, q21_botanist, q21_hr)
q21_n <- length(unique(q21_all$id))
# Manipulate data into a graphable format
q21_plot <-
q21_all %>%
group_by(response) %>%
summarize(count = n()) %>%
mutate(percent_all = count / sum(count)) %>%
mutate(percent_responded = count / q21_n)
# Plot with percents and response counts
r <-
ggplot(q21_plot, aes(x = reorder(response, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded, 2), count, sep = "***")))
r
# Load libraries
library(tidyverse)
library(ggplot2)
library(stringr)
source("helper0.R")
raw_data <- read.csv("data/master.csv", stringsAsFactors = FALSE)
q <- "How.many.total.prescription.medications.are.you.currently.taking...Please.insert.number."
q_data <- get_single_selection(data = raw_data, q.name = q)
q_n <- length(unique(q_data$id))
# Manipulate data into a graphable format
q_plot <-
q_data %>%
group_by(response) %>%
summarize(count = n()) %>%
mutate(percent_responded = round(100*(count / q_n), 2)) %>%
arrange(desc(count))
# Plot with percents and response counts
r <-
ggplot(q_plot, aes(x = reorder(response, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded, 0), count, sep = "%:"))) +
xlab("Response") +
ylab("% Responded, Count") +
labs(title = "How many total prescription medications are you currently taking? (Please insert number)", subtitle = q_n)
r
# Save graph as PNG, plot data as csv, and all question data including response IDs as csv (save question n and N at end of plot file as "_x.x")
ggsave(filename = 'q21_total_prescriptions.png', plot = r, device = 'png')
write.csv(q21_plot, 'q21_total_prescriptions_217.csv', row.names = FALSE)
write.csv(q21_all, 'q21_total_prescriptions_ids.csv', row.names = FALSE)
# Save graph as PNG, plot data as csv, and all question data including response IDs as csv (save question n and N at end of plot file as "_x.x")
ggsave(filename = 'q21_total_prescriptions.png', plot = r, device = 'png')
write.csv(q_plot, 'q21_total_prescriptions_217.csv', row.names = FALSE)
write.csv(q_data, 'q21_total_prescriptions_ids.csv', row.names = FALSE)
q <- "Do.you.have.prescription.medications.in.your.house.that.you.don.t.want.to.use.and.currently.need.to.get.rid.of."
q_data <- get_single_selection(data = raw_data, q.name = q)
q_n <- length(unique(q_data$id))
# Manipulate data into a graphable format
q_plot <-
q_data %>%
group_by(response) %>%
summarize(count = n()) %>%
mutate(percent_responded = round(100*(count / q_n), 2)) %>%
arrange(desc(count))
# Plot with percents and response counts
r <-
ggplot(q_plot, aes(x = reorder(response, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded, 0), count, sep = "%:"))) +
xlab("Response") +
ylab("% Responded, Count") +
labs(title = "Do you have prescription medications in your house that you don't want to use and currently need to get rid of?", subtitle = q_n)
r
# Save graph as PNG, plot data as csv, and all question data including response IDs as csv (save question n and N at end of plot file as "_x.x")
ggsave(filename = 'q22_unwanted_medication.png', plot = r, device = 'png')
write.csv(q_plot, 'q22_unwanted_medication_217.csv', row.names = FALSE)
write.csv(q_data, 'q22_unwanted_medication_ids.csv', row.names = FALSE)
q <- "Do.you.have.prescription.drug.coverage."
q_data <- get_single_selection(data = raw_data, q.name = q)
q_n <- length(unique(q_data$id))
# Manipulate data into a graphable format
q_plot <-
q_data %>%
group_by(response) %>%
summarize(count = n()) %>%
mutate(percent_responded = round(100*(count / q_n), 2)) %>%
arrange(desc(count))
# Plot with percents and response counts
r <-
ggplot(q_plot, aes(x = reorder(response, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded, 0), count, sep = "%:"))) +
xlab("Response") +
ylab("% Responded, Count") +
labs(title = "Do you have prescription drug coverage?", subtitle = q_n)
r
# Save graph as PNG, plot data as csv, and all question data including response IDs as csv (save question n and N at end of plot file as "_x.x")
ggsave(filename = 'q31_drug_coverage.png', plot = r, device = 'png')
write.csv(q_plot, 'q31_drug_coverage_217.csv', row.names = FALSE)
write.csv(q_data, 'q31_drug_coverage_ids.csv', row.names = FALSE)
# Load libraries
library(tidyverse)
library(ggplot2)
library(stringr)
source("helper.R")
raw_data <- read.csv("data/master.csv", stringsAsFactors = FALSE)
q <- "Do.you.currently.have.health.insurance...Please.select.one."
q_data <- get_single_selection(data = raw_data, q.name = q)
q_n <- length(unique(q_data$id))
# Manipulate data into a graphable format
q_plot <-
q_data %>%
group_by(response) %>%
summarize(count = n()) %>%
mutate(percent_responded = round(100*(count / q_n), 2)) %>%
arrange(desc(count))
# Plot with percents and response counts
r <-
ggplot(q_plot, aes(x = reorder(response, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded, 0), count, sep = "%:"))) +
xlab("Response") +
ylab("% Responded, Count") +
labs(title = "Do you currently have health insurance? (Please select one)", subtitle = q_n)
r
# Save graph as PNG, plot data as csv, and all question data including response IDs as csv (save question n and N at end of plot file as "_x.x")
ggsave(filename = 'q30_health_insurance.png', plot = r, device = 'png')
write.csv(q_plot, 'q30_health_insurance_217.csv', row.names = FALSE)
write.csv(q_data, 'q30_health_insurance_ids.csv', row.names = FALSE)
# Load libraries
library(tidyverse)
library(ggplot2)
library(stringr)
source("helper.R")
raw_data <- read.csv("data/master.csv", stringsAsFactors = FALSE)
q <- "Where.how.do.you.get.your.medications."
q_data <- get_single_selection(data = raw_data, q.name = q)
q_n <- length(unique(q_data$id))
# Manipulate data into a graphable format
q_plot <-
q_data %>%
group_by(response) %>%
summarize(count = n()) %>%
mutate(percent_responded = round(100*(count / q_n), 2)) %>%
arrange(desc(count))
# Plot with percents and response counts
r <-
ggplot(q_plot, aes(x = reorder(response, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded, 0), count, sep = "%:"))) +
xlab("Response") +
ylab("% Responded, Count") +
labs(title = "Where/how do you get your medications?", subtitle = q_n)
r
# Save graph as PNG, plot data as csv, and all question data including response IDs as csv (save question n and N at end of plot file as "_x.x")
ggsave(filename = 'q32_medication_sourcing.png', plot = r, device = 'png')
write.csv(q_plot, 'q32_medication_sourcing_217.csv', row.names = FALSE)
write.csv(q_data, 'q32_medication_sourcing_ids.csv', row.names = FALSE)
# Load libraries
library(tidyverse)
library(ggplot2)
library(stringr)
source("helper0.R")
# Read in raw data from the Veterans surveys. These are the files downloaded from survey monkey saved as a .csv
raw_data_general <- read.csv("data/master.csv", stringsAsFactors = FALSE)
# Pull out all responses for q33 (a single selection question) combine, then determine 'question n'
q33 <- "On.average..how.much.do.you.pay..in.US.dollars..for.your.medications.on.a.monthly.basis.out.of.pocket."
q33_all <- get_single_selection(data = raw_data_general, q.name = q33)
q33_n <- length(unique(q33_all$id))
histogram_object <- hist(as.numeric(all_data$response))
histogram_object$breaks = c(0, 200, 400, 600, 800, 1000, 1200, 1400)
histogram_object$counts
plot(histogram_object)
# Read in raw data from the Veterans surveys. These are the files downloaded from survey monkey saved as a .csv
raw_data<- read.csv("data/master.csv", stringsAsFactors = FALSE)
# Read in raw data from the Veterans surveys. These are the files downloaded from survey monkey saved as a .csv
raw_data<- read.csv("data/master.csv", stringsAsFactors = FALSE)
# Pull out all responses for q33 (a single selection question) combine, then determine 'question n'
q <- "On.average..how.much.do.you.pay..in.US.dollars..for.your.medications.on.a.monthly.basis.out.of.pocket."
q_data <- get_single_selection(data = raw_data_general, q.name = q33)
q33_n <- length(unique(q33_all$id))
# Pull out all responses for q33 (a single selection question) combine, then determine 'question n'
q <- "On.average..how.much.do.you.pay..in.US.dollars..for.your.medications.on.a.monthly.basis.out.of.pocket."
q_data <- get_single_selection(data = raw_data_general, q.name = q33)
q_n <- length(unique(q_data$id))
histogram_object <- hist(as.numeric(all_data$response))
histogram_object$breaks = c(0, 200, 400, 600, 800, 1000, 1200, 1400)
histogram_object$counts
plot(histogram_object)
# Load libraries
library(tidyverse)
library(ggplot2)
library(stringr)
source("helper0.R")
# Read in raw data from the Veterans surveys. These are the files downloaded from survey monkey saved as a .csv
raw_data<- read.csv("data/master.csv", stringsAsFactors = FALSE)
# Pull out all responses for q33 (a single selection question) combine, then determine 'question n'
q <- "On.average..how.much.do.you.pay..in.US.dollars..for.your.medications.on.a.monthly.basis.out.of.pocket."
q_data <- get_single_selection(data = raw_data_general, q.name = q33)
q_n <- length(unique(q_data$id))
# Save all question data including response IDs as csv (save question n and N at end of file as "_x.x")
write.csv(q_data, 'q33_med_cost_monthly_217.csv', row.names = FALSE)
# Pull out all responses for q33 (a single selection question) combine, then determine 'question n'
q <- "On.average..how.much.do.you.pay..in.US.dollars..for.your.medications.on.a.monthly.basis.out.of.pocket."
q_data <- get_single_selection(data = raw_data_general, q.name = q33) %>%
arrange(desc)
q_n <- length(unique(q_data$id))
# Pull out all responses for q33 (a single selection question) combine, then determine 'question n'
q <- "On.average..how.much.do.you.pay..in.US.dollars..for.your.medications.on.a.monthly.basis.out.of.pocket."
q_data <- get_single_selection(data = raw_data_general, q.name = q33) %>%
arrange(response, desc)
q_n <- length(unique(q_data$id))
# Load libraries
library(tidyverse)
library(ggplot2)
library(stringr)
source("helper.R")
raw_data <- read.csv("data/master.csv", stringsAsFactors = FALSE)
q <- "Do.you.seek.supportive.mental.health.services..counseling..or.other.therapy.within.or.outside.of.the.VA."
q_data <- get_single_selection(data = raw_data, q.name = q)
q_n <- length(unique(q_data$id))
# Manipulate data into a graphable format
q_plot <-
q_data %>%
group_by(response) %>%
summarize(count = n()) %>%
mutate(percent_responded = round(100*(count / q_n), 2)) %>%
arrange(desc(count))
# Plot with percents and response counts
r <-
ggplot(q_plot, aes(x = reorder(response, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded, 0), count, sep = "%:"))) +
xlab("Response") +
ylab("% Responded, Count") +
labs(title = "Do you seek supportive mental health services, counseling, or other therapy within or outside of the VA?", subtitle = q_n)
r
# Save graph as PNG, plot data as csv, and all question data including response IDs as csv (save question n and N at end of plot file as "_x.x")
ggsave(filename = 'q34_mental_health_services.png', plot = r, device = 'png')
write.csv(q34_plot, 'q34_mental_health_services_217.csv', row.names = FALSE)
write.csv(q34_all, 'q34_mental_health_services_ids.csv', row.names = FALSE)
# Save graph as PNG, plot data as csv, and all question data including response IDs as csv (save question n and N at end of plot file as "_x.x")
ggsave(filename = 'q34_mental_health_services.png', plot = r, device = 'png')
write.csv(q_plot, 'q34_mental_health_services_217.csv', row.names = FALSE)
write.csv(q_data, 'q34_mental_health_services_ids.csv', row.names = FALSE)
# Load libraries
library(tidyverse)
library(ggplot2)
library(stringr)
source("helper.R")
raw_data <- read.csv("data/master.csv", stringsAsFactors = FALSE)
q <- "Do.you.use.cannabis.for.medical.purposes."
q_data <- get_single_selection(data = raw_data, q.name = q)
q_n <- length(unique(q_data$id))
# Manipulate data into a graphable format
q_plot <-
q_data %>%
group_by(response) %>%
summarize(count = n()) %>%
mutate(percent_responded = round(100*(count / q_n), 2)) %>%
arrange(desc(count))
# Plot with percents and response counts
r <-
ggplot(q_plot, aes(x = reorder(response, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded, 0), count, sep = "%:"))) +
xlab("Response") +
ylab("% Responded, Count") +
labs(title = "Do you use cannabis for medical purposes?", subtitle = q_n)
r
# Save graph as PNG, plot data as csv, and all question data including response IDs as csv (save question n and N at end of plot file as "_x.x")
ggsave(filename = 'q35_medical_cannabis.png', plot = r, device = 'png')
write.csv(q_plot, 'q35_medical_cannabis_217.csv', row.names = FALSE)
write.csv(q_data, 'q35_medical_cannabis_ids.csv', row.names = FALSE)
# Load libraries
library(tidyverse)
library(ggplot2)
library(stringr)
source("helper.R")
# Load libraries
library(tidyverse)
library(ggplot2)
library(stringr)
source("helper.R")
raw_data <- read.csv("data/master.csv", stringsAsFactors = FALSE)
q <- "Do.you.use.cannabis.for.recreational.purposes."
q_data <- get_single_selection(data = raw_data, q.name = q)
q_n <- length(unique(q_data$id))
# Manipulate data into a graphable format
q_plot <-
q_data %>%
group_by(response) %>%
summarize(count = n()) %>%
mutate(percent_responded = round(100*(count / q_n), 2)) %>%
arrange(desc(count))
# Plot with percents and response counts
r <-
ggplot(q_plot, aes(x = reorder(response, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded, 0), count, sep = "%:"))) +
xlab("Response") +
ylab("% Responded, Count") +
labs(title = "Do you use cannabis for recreational purposes?", subtitle = q_n)
r
# Plot with percents and response counts
r <-
ggplot(q_plot, aes(x = reorder(response, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded, 0), count, sep = "%:"))) +
xlab("Response") +
ylab("% Responded, Count") +
labs(title = "Do you use cannabis for recreational purposes?", subtitle = q_n)
r
# Save graph as PNG, plot data as csv, and all question data including response IDs as csv (save question n and N at end of plot file as "_x.x")
ggsave(filename = 'q36_rec_cannabis.png', plot = r, device = 'png')
write.csv(q_plot, 'q36_rec_cannabis_217.csv', row.names = FALSE)
write.csv(q_data, 'q36_rec_cannabis_ids.csv', row.names = FALSE)
# Pull out all responses for q5 (a choose all question), combine, turn into a tidy data format for further processing then d <- tidy_choose_all(q)etermine 'question n'
q <- 'Under.what.circumstances.do.you.use.cannabis...Please.select.all.that.apply.'
q_final_response <- "X.153"
q_data <- get_choose_all(raw_data, q.name = q, f.response = q_final_response) %>%
tidy_choose_all()
q_n <- length(unique(q_data$id))
# Manipulate data into a graphable format
q_plot <-
q_data %>%
group_by(chosen) %>%
summarize(count = n()) %>%
mutate(percent_responded = round(100*(count / q_n), 2)) %>%
arrange(desc(count))
# Plot with percents and response counts
r <-
ggplot(q_plot, aes(x = reorder(chosen, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded, 0), count, sep = "%:"))) +
xlab("Response") +
ylab("% Responded, Count") +
labs(title = "Under what circumstances do you use cannabis? (Please select all that apply)", subtitle = q_n)
r
# Save graph as PNG, plot data as csv, and all question data including response IDs as csv (save question n and N at end of plot file as "_x.x")
ggsave(filename = 'q37_cannabis_uses.png', plot = r, device = 'png')
write.csv(q_plot, 'q37_cannabis_uses_217.csv', row.names = FALSE)
write.csv(q_data, 'q37_cannabis_uses_ids.csv', row.names = FALSE)
