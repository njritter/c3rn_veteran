q102_hr <- get_single_selection(data = raw_data_hr, q.name = q103)
q102_all <- rbind(q102_general, q102_bask, q102_botanist, q102_hr)
q102_n <- length(unique(q102_all$id))
# Manipulate data into a graphable format
q102_plot <-
q102_all %>%
group_by(response) %>%
summarize(count = n()) %>%
mutate(percent_all = count / sum(count)) %>%
mutate(percent_responded = count / q102_n)
# Plot with percents and response counts
r <-
ggplot(q102_plot, aes(x = reorder(response, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded, 2), count, sep = "***")))
r
# Save graph as PNG, plot data as csv, and all question data including response IDs as csv (save question n and N at end of plot file as "_x.x")
ggsave(filename = 'q102_vet_cannabis_discount.png', plot = r, device = 'png')
write.csv(q102_plot, 'q102_vet_cannabis_discount_431.csv', row.names = FALSE)
write.csv(q102_all, 'q102_vet_cannabis_discount_ids.csv', row.names = FALSE)
# Pull out all responses for q102 (a single selection question) combine, then determine 'question n'
q102 <- "Do.you.believe.the.VA.should.offer.free..or.discounted..medical.cannabis.to.veterans.who.qualify.for.its.use."
q103 <- "Do.you.believe.the.VA.should.offerÃ‚.free..or.discounted..medical.cannabis.to.veterans.who.qualify.for.its.use."
q102_general <- get_single_selection(data = raw_data_general, q.name = q102)
q102_bask <- get_single_selection(data = raw_data_bask, q.name = q102)
q102_botanist <- get_single_selection(data = raw_data_botanist, q.name = q102)
q102_hr <- get_single_selection(data = raw_data_hr, q.name = q103)
q102_all <- rbind(q102_general, q102_bask, q102_botanist, q102_hr) %>%
inner_join(ma_ids, by = "id")
q102_m_n <- length(unique(q102_all$id))
# Manipulate data into a graphable format
q102_plot <-
q102_all %>%
group_by(response) %>%
summarize(count = n()) %>%
mutate(percent_all = count / sum(count)) %>%
mutate(percent_responded = count / q102_m_n)
# Manipulate data into a graphable format
q102_plot <-
q102_all %>%
group_by(response.x) %>%
summarize(count = n()) %>%
mutate(percent_all = count / sum(count)) %>%
mutate(percent_responded = count / q102_m_n)
# Plot with percents and response counts
r <-
ggplot(q102_plot, aes(x = reorder(response.x, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded, 2), count, sep = "***")))
r
# Save graph as PNG, plot data as csv, and all question data including response IDs as csv (save question n and N at end of plot file as "_x.x")
ggsave(filename = 'q102_vet_cannabis_discount.png', plot = r, device = 'png')
write.csv(q102_plot, 'q102_vet_cannabis_discount_161.csv', row.names = FALSE)
write.csv(q102_all, 'q102_vet_cannabis_discount_ids.csv', row.names = FALSE)
# Pull out all responses for q93 (a single selection question) combine, then determine 'question n'
q93 <- "What.is.your.current.employment.status."
q93_general <- get_single_selection(data = raw_data_general, q.name = q93)
q93_bask <- get_single_selection(data = raw_data_bask, q.name = q93)
q93_botanist <- get_single_selection(data = raw_data_botanist, q.name = q93)
q93_hr <- get_single_selection(data = raw_data_hr, q.name = q93)
q93_all <- rbind(q93_general, q93_bask, q93_botanist, q93_hr)
q93_n <- length(unique(q93_all$id))
# Manipulate data into a graphable format
q93_plot <-
q93_all %>%
group_by(response) %>%
summarize(count = n()) %>%
mutate(percent_all = count / sum(count)) %>%
mutate(percent_responded = count / q93_n)
# Plot with percents and response counts
r <-
ggplot(q93_plot, aes(x = reorder(response, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded, 2), count, sep = "***")))
r
# Save graph as PNG, plot data as csv, and all question data including response IDs as csv (save question n and N at end of plot file as "_x.x")
ggsave(filename = 'q93_employment_status.png', plot = r, device = 'png')
write.csv(q93_plot, 'q93_employment_status_431.csv', row.names = FALSE)
write.csv(q93_all, 'q93_employment_status_ids.csv', row.names = FALSE)
# Pull out all responses for q93 (a single selection question) combine, then determine 'question n'
q93 <- "What.is.your.current.employment.status."
q93_general <- get_single_selection(data = raw_data_general, q.name = q93)
q93_bask <- get_single_selection(data = raw_data_bask, q.name = q93)
q93_botanist <- get_single_selection(data = raw_data_botanist, q.name = q93)
q93_hr <- get_single_selection(data = raw_data_hr, q.name = q93)
q93_all <- rbind(q93_general, q93_bask, q93_botanist, q93_hr) %>%
inner_join(ma_ids, by = "id")
q93_m_n <- length(unique(q93_all$id))
# Manipulate data into a graphable format
q93_plot <-
q93_all %>%
group_by(response.x) %>%
summarize(count = n()) %>%
mutate(percent_all = count / sum(count)) %>%
mutate(percent_responded = count / q93_m_n)
# Plot with percents and response counts
r <-
ggplot(q93_plot, aes(x = reorder(response.x, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded, 2), count, sep = "***")))
r
# Save graph as PNG, plot data as csv, and all question data including response IDs as csv (save question n and N at end of plot file as "_x.x")
ggsave(filename = 'q93_employment_status.png', plot = r, device = 'png')
write.csv(q93_plot, 'q93_employment_status_161.csv', row.names = FALSE)
write.csv(q93_all, 'q93_employment_status_ids.csv', row.names = FALSE)
# Load libraries
library(tidyverse)
library(ggplot2)
library(stringr)
source("helper.R")
# Load libraries
library(tidyverse)
library(ggplot2)
library(stringr)
source("helper.R")
# Read in raw data from the Veterans surveys. These are the files downloaded from survey monkey saved as a .csv
raw_data_general <- read.csv("data/general.csv", stringsAsFactors = FALSE)
raw_data_botanist <- read.csv("data/botanist.csv", stringsAsFactors = FALSE)
raw_data_bask <- read.csv("data/bask.csv", stringsAsFactors = FALSE)
raw_data_hr <- read.csv("data/hr.csv", stringsAsFactors = FALSE)
# Pull out all responses for q98 (a single selection question) combine, then determine 'question n' (subsequent q are labeled for convenience, do not respond to survey q#)
q98 <- "What.state.in.the.US.do.you.currently.live.in."
q99 <- "What.US.State.do.you.currently.live.in."
q100 <- "Which.US.state.do.you.currently.live.in."
q101 <- "What.US.state.do.you.currently.live.in."
q98_general <- get_single_selection(data = raw_data_general, q.name = q98)
q98_bask <- get_single_selection(data = raw_data_bask, q.name = q99)
q98_botanist <- get_single_selection(data = raw_data_botanist, q.name = q100)
q98_hr <- get_single_selection(data = raw_data_hr, q.name = q101)
q98_all <- rbind(q98_general, q98_bask, q98_botanist, q98_hr)
ma_ids <- q98_all %>%
filter(response %in% c("Massachusetts"))
state_ma <- length(unique(ma_ids$id))
# Pull out all responses for q33 (a single selection question) combine, then determine 'question n'
q33 <- "On.average..how.much.do.you.pay..in.US.dollars..for.your.medications.on.a.monthly.basis.out.of.pocket."
q33_general <- get_single_selection(data = raw_data_general, q.name = q33)
q33_bask <- get_single_selection(data = raw_data_bask, q.name = q33)
q33_botanist <- get_single_selection(data = raw_data_botanist, q.name = q33)
q33_hr <- get_single_selection(data = raw_data_hr, q.name = q33)
q33_all <- rbind(q33_general, q33_bask, q33_botanist, q33_hr) %>%
inner_join(ma_ids, by = "id")
q33_m_n <- length(unique(q33_all$id))
# Load libraries
library(tidyverse)
library(ggplot2)
library(stringr)
source("helper.R")
# Load libraries
library(tidyverse)
library(ggplot2)
library(stringr)
source("helper.R")
# Read in raw data from the Veterans surveys. These are the files downloaded from survey monkey saved as a .csv
raw_data_general <- read.csv("data/general_text.csv", stringsAsFactors = FALSE)
raw_data_botanist <- read.csv("data/botanist_text.csv", stringsAsFactors = FALSE)
raw_data_bask <- read.csv("data/bask_text.csv", stringsAsFactors = FALSE)
raw_data_hr <- read.csv("data/hr_text.csv", stringsAsFactors = FALSE)
setwd("C:/Users/DJR52/OneDrive/c3rn_veteran")
# Load libraries
library(tidyverse)
library(ggplot2)
library(stringr)
source("helper.R")
# Read in raw data from the Veterans surveys. These are the files downloaded from survey monkey saved as a .csv
raw_data_general <- read.csv("data/general_text.csv", stringsAsFactors = FALSE)
raw_data_botanist <- read.csv("data/botanist_text.csv", stringsAsFactors = FALSE)
raw_data_bask <- read.csv("data/bask_text.csv", stringsAsFactors = FALSE)
raw_data_hr <- read.csv("data/hr_text.csv", stringsAsFactors = FALSE)
# Read in raw data from the Veterans surveys. These are the files downloaded from survey monkey saved as a .csv
raw_data_general <- read.csv("data/general.csv", stringsAsFactors = FALSE)
raw_data_botanist <- read.csv("data/botanist.csv", stringsAsFactors = FALSE)
raw_data_bask <- read.csv("data/bask.csv", stringsAsFactors = FALSE)
raw_data_hr <- read.csv("data/hr.csv", stringsAsFactors = FALSE)
# Pull out all responses for q90 (a single selection question) and combine
q90 <- "What.is.your.annual.household.income..in.US.dollars."
q90_general <- get_single_selection(data = raw_data_general, q.name = q90)
q90_bask <- get_single_selection(data = raw_data_bask, q.name = q90)
q90_botanist <- get_single_selection(data = raw_data_botanist, q.name = q90)
q90_hr <- get_single_selection(data = raw_data_hr, q.name = q90)
q90_data <- rbind(q90_general, q90_bask, q90_botanist, q90_hr)
q90_n <- length(unique(all_data$id))
# Pull out all responses for q90 (a single selection question) and combine
q90 <- "What.is.your.annual.household.income..in.US.dollars."
q90_general <- get_single_selection(data = raw_data_general, q.name = q90)
q90_bask <- get_single_selection(data = raw_data_bask, q.name = q90)
q90_botanist <- get_single_selection(data = raw_data_botanist, q.name = q90)
q90_hr <- get_single_selection(data = raw_data_hr, q.name = q90)
all_data <- rbind(q90_general, q90_bask, q90_botanist, q90_hr)
q90_n <- length(unique(all_data$id))
# Pull out all responses for q90 (a single selection question) and combine
q90 <- "What.is.your.annual.household.income..in.US.dollars."
q90_general <- get_single_selection(data = raw_data_general, q.name = q90)
q90_bask <- get_single_selection(data = raw_data_bask, q.name = q90)
q90_botanist <- get_single_selection(data = raw_data_botanist, q.name = q90)
q90_hr <- get_single_selection(data = raw_data_hr, q.name = q90)
q90_all <- rbind(q90_general, q90_bask, q90_botanist, q90_hr)
q90_n <- length(unique(q90_all_data$id))
# Pull out all responses for q90 (a single selection question) and combine
q90 <- "What.is.your.annual.household.income..in.US.dollars."
q90_general <- get_single_selection(data = raw_data_general, q.name = q90)
q90_bask <- get_single_selection(data = raw_data_bask, q.name = q90)
q90_botanist <- get_single_selection(data = raw_data_botanist, q.name = q90)
q90_hr <- get_single_selection(data = raw_data_hr, q.name = q90)
q90_all <- rbind(q90_general, q90_bask, q90_botanist, q90_hr)
q90_n <- length(unique(q90_all$id))
# Load libraries
library(tidyverse)
library(ggplot2)
library(stringr)
source("helper.R")
# Read in raw data from the Veterans surveys. These are the files downloaded from survey monkey saved as a .csv
raw_data_general <- read.csv("data/general.csv", stringsAsFactors = FALSE)
raw_data_botanist <- read.csv("data/botanist.csv", stringsAsFactors = FALSE)
raw_data_bask <- read.csv("data/bask.csv", stringsAsFactors = FALSE)
raw_data_hr <- read.csv("data/hr.csv", stringsAsFactors = FALSE)
# Pull out all responses for q90 (a single selection question) and combine
q90 <- "What.is.your.annual.household.income..in.US.dollars."
q90_general <- get_single_selection(data = raw_data_general, q.name = q90)
q90_bask <- get_single_selection(data = raw_data_bask, q.name = q90)
q90_botanist <- get_single_selection(data = raw_data_botanist, q.name = q90)
q90_hr <- get_single_selection(data = raw_data_hr, q.name = q90)
q90_all <- rbind(q90_general, q90_bask, q90_botanist, q90_hr)
q90_n <- length(unique(q90_all$id))
write.csv(raw_data_general, 'raw_general.csv', row.names = FALSE)
write.csv(raw_data_botanist, 'raw_botanist.csv', row.names = FALSE)
write.csv(raw_data_bask, 'raw_bask.csv', row.names = FALSE)
write.csv(raw_data_hr, 'raw_hr.csv', row.names = FALSE)
# Load libraries
library(tidyverse)
library(ggplot2)
library(stringr)
source("helper.R")
# Load libraries
library(tidyverse)
library(ggplot2)
library(stringr)
source("helper.R")
# Read in raw data from the Veterans surveys. These are the files downloaded from survey monkey saved as a .csv
raw_data_general <- read.csv("data/general.csv", stringsAsFactors = FALSE)
raw_data_botanist <- read.csv("data/botanist.csv", stringsAsFactors = FALSE)
raw_data_bask <- read.csv("data/bask.csv", stringsAsFactors = FALSE)
raw_data_hr <- read.csv("data/hr.csv", stringsAsFactors = FALSE)
# Pull out all responses for q98 (a single selection question) combine, then determine 'question n' (subsequent q are labeled for convenience, do not respond to survey q#)
q98 <- "What.state.in.the.US.do.you.currently.live.in."
q99 <- "What.US.State.do.you.currently.live.in."
q100 <- "Which.US.state.do.you.currently.live.in."
q101 <- "What.US.state.do.you.currently.live.in."
q98_general <- get_single_selection(data = raw_data_general, q.name = q98)
q98_bask <- get_single_selection(data = raw_data_bask, q.name = q99)
q98_botanist <- get_single_selection(data = raw_data_botanist, q.name = q100)
q98_hr <- get_single_selection(data = raw_data_hr, q.name = q101)
q98_all <- rbind(q98_general, q98_bask, q98_botanist, q98_hr)
ma_ids <- q98_all %>%
filter(response %in% c("Massachusetts"))
state_ma <- length(unique(ma_ids$id))
raw_data_all <- rbind(raw_data_general, raw_data_botanist, raw_data_bask, raw_data_hr) %>%
inner_join(ma_ids, by = "id")
names(raw_data_botanist) <- raw_data_general
names(raw_data_bask) <- raw_data_general
names(raw_data_hr) <- raw_data_general
raw_data_all <- rbind(raw_data_general, raw_data_botanist, raw_data_bask, raw_data_hr) %>%
inner_join(ma_ids, by = "id")
# Load libraries
library(tidyverse)
library(ggplot2)
library(stringr)
source("helper.R")
# Load libraries
library(tidyverse)
library(ggplot2)
library(stringr)
source("helper.R")
# Read in raw data from the Veterans surveys. These are the files downloaded from survey monkey saved as a .csv
raw_data_general <- read.csv("data/general.csv", stringsAsFactors = FALSE)
raw_data_botanist <- read.csv("data/botanist.csv", stringsAsFactors = FALSE)
raw_data_bask <- read.csv("data/bask.csv", stringsAsFactors = FALSE)
raw_data_hr <- read.csv("data/hr.csv", stringsAsFactors = FALSE)
# Pull out all responses for q98 (a single selection question) combine, then determine 'question n' (subsequent q are labeled for convenience, do not respond to survey q#)
q98 <- "What.state.in.the.US.do.you.currently.live.in."
q99 <- "What.US.State.do.you.currently.live.in."
q100 <- "Which.US.state.do.you.currently.live.in."
q101 <- "What.US.state.do.you.currently.live.in."
q98_general <- get_single_selection(data = raw_data_general, q.name = q98)
q98_bask <- get_single_selection(data = raw_data_bask, q.name = q99)
q98_botanist <- get_single_selection(data = raw_data_botanist, q.name = q100)
q98_hr <- get_single_selection(data = raw_data_hr, q.name = q101)
q98_all <- rbind(q98_general, q98_bask, q98_botanist, q98_hr)
ma_ids <- q98_all %>%
filter(response %in% c("Massachusetts"))
state_ma <- length(unique(ma_ids$id))
ma_data_general <- raw_data_general %>%
inner_join(ma_ids, by = "id")
ma_data_botanist <- raw_data_botanist %>%
inner_join(ma_ids, by = "id")
ma_data_bask <- raw_data_bask %>%
inner_join(ma_ids, by = "id")
ma_data_hr <- raw_data_hr %>%
inner_join(ma_ids, by = "id")
# Load libraries
library(tidyverse)
library(ggplot2)
library(stringr)
source("helper.R")
# Load libraries
library(tidyverse)
library(ggplot2)
library(stringr)
source("helper.R")
# Read in raw data from the Veterans surveys. These are the files downloaded from survey monkey saved as a .csv
raw_data_general <- read.csv("data/general.csv", stringsAsFactors = FALSE)
raw_data_botanist <- read.csv("data/botanist.csv", stringsAsFactors = FALSE)
raw_data_bask <- read.csv("data/bask.csv", stringsAsFactors = FALSE)
raw_data_hr <- read.csv("data/hr.csv", stringsAsFactors = FALSE)
# Pull out all responses for q77 (a choose all question), combine, turn into a tidy data format for further processing then determine 'question n'
q77 <- "What.war.s..did.you.serve.in...Please.select.all.that.apply."
q77_general_final_response <- "X.373"
q77_bask_final_response <- "X.1612"
q77_botanist_final_response <- "X.2772"
q77_hr_final_response <- "X.945"
q77_general <- get_choose_all(raw_data_general, q.name = q77, f.response = q77_general_final_response)
q77_bask <- get_choose_all(raw_data_bask, q.name = q77, f.response = q77_bask_final_response)
q77_botanist <- get_choose_all(raw_data_botanist, q.name = q77, f.response = q77_botanist_final_response)
q77_hr <- get_choose_all(data = raw_data_hr, q.name = q77, f.response = q77_hr_final_response)
q77_all <-
rbind(q77_general, q77_bask, q77_botanist, q77_hr) %>%
tidy_choose_all() %>%
inner_join(ma_ids, by = "id")
q77_n <- length(unique(q77_all$id))
# Pull out all responses for q77 (a choose all question), combine, turn into a tidy data format for further processing then determine 'question n'
q77 <- "What.war.s..did.you.serve.in...Please.select.all.that.apply."
q77_general_final_response <- "X.373"
q77_bask_final_response <- "X.1612"
q77_botanist_final_response <- "X.2772"
q77_hr_final_response <- "X.945"
q77_general <- get_choose_all(raw_data_general, q.name = q77, f.response = q77_general_final_response)
q77_bask <- get_choose_all(raw_data_bask, q.name = q77, f.response = q77_bask_final_response)
q77_botanist <- get_choose_all(raw_data_botanist, q.name = q77, f.response = q77_botanist_final_response)
q77_hr <- get_choose_all(data = raw_data_hr, q.name = q77, f.response = q77_hr_final_response)
q77_all <-
rbind(q77_general, q77_bask, q77_botanist, q77_hr) %>%
tidy_choose_all()
q77_n <- length(unique(q77_all$id))
# Manipulate data into a graphable format
q77_plot <-
q77_all %>%
group_by(chosen) %>%
summarize(count = n()) %>%
mutate(percent_all = count / sum(count)) %>%
mutate(percent_responded = count / q77_n)
# Plot with percents and response counts
r <-
ggplot(q77_plot, aes(x = reorder(chosen, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded,2), count, sep = "***")))
r
# Save graph as PNG, plot data as csv, and all question data including response IDs as csv (save question n and N at end of plot file as "_x.x")
ggsave(filename = 'q77_wars_served.png', plot = r, device = 'png')
write.csv(q77_plot, 'q77_wars_served_430.csv', row.names = FALSE)
write.csv(q77_all, 'q77_wars_served_ids.csv', row.names = FALSE)
# Pull out all responses for q59 (a single selection question) and combine
q59 <- "Are.you.concerned.about.your.workplace.knowing.about.your.cannabis.use."
q59_general <- get_single_selection(data = raw_data_general, q.name = q59)
q59_bask <- get_single_selection(data = raw_data_bask, q.name = q59)
q59_botanist <- get_single_selection(data = raw_data_botanist, q.name = q59)
q59_hr <- get_single_selection(data = raw_data_hr, q.name = q59)
q59_all <- rbind(q59_general, q59_bask, q59_botanist, q59_hr)
q59_n <- length(unique(q59_all$id))
setwd("C:/Users/DJR52/OneDrive/c3rn_veteran")
# Load libraries
library(tidyverse)
library(ggplot2)
library(stringr)
source("helper.R")
# Read in raw data from the Veterans surveys. These are the files downloaded from survey monkey saved as a .csv
raw_data_general <- read.csv("data/general.csv", stringsAsFactors = FALSE)
raw_data_botanist <- read.csv("data/botanist.csv", stringsAsFactors = FALSE)
raw_data_bask <- read.csv("data/bask.csv", stringsAsFactors = FALSE)
raw_data_hr <- read.csv("data/hr.csv", stringsAsFactors = FALSE)
# Pull out all responses for q59 (a single selection question) and combine
q59 <- "Are.you.concerned.about.your.workplace.knowing.about.your.cannabis.use."
q59_general <- get_single_selection(data = raw_data_general, q.name = q59)
q59_bask <- get_single_selection(data = raw_data_bask, q.name = q59)
q59_botanist <- get_single_selection(data = raw_data_botanist, q.name = q59)
q59_hr <- get_single_selection(data = raw_data_hr, q.name = q59)
q59_all <- rbind(q59_general, q59_bask, q59_botanist, q59_hr)
q59_n <- length(unique(q59_all$id))
# Manipulate data into a graphable format
q59_plot <-
q59_all %>%
group_by(response) %>%
summarize(count = n()) %>%
mutate(percent_all = count / sum(count)) %>%
mutate(percent_responded = count / q59_n)
# Plot with percents and response counts
r <-
ggplot(q59_plot, aes(x = reorder(response, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded, 2), count, sep = "***")))
r
# Save graph as PNG, plot data as csv, and all question data including response IDs as csv (save question n and N at end of plot file as "_x.x")
ggsave(filename = 'q59_workplace_cannabis_knowledge.png', plot = r, device = 'png')
write.csv(q59_plot, 'q59_workplace_cannabis_knowledge_431.csv', row.names = FALSE)
write.csv(q59_all, 'q59_workplace_cannabis_knowledge_ids.csv', row.names = FALSE)
# Pull out all responses for q60 (a single selection question) and combine
q60 <- "Are.you.concerned.that.your.workplace.or.other.agency.will.test.you.for.your.cannabis.use."
q60_general <- get_single_selection(data = raw_data_general, q.name = q60)
q60_bask <- get_single_selection(data = raw_data_bask, q.name = q60)
q60_botanist <- get_single_selection(data = raw_data_botanist, q.name = q60)
q60_hr <- get_single_selection(data = raw_data_hr, q.name = q60)
q60_all <- rbind(q60_general, q60_bask, q60_botanist, q60_hr)
q60_n <- length(unique(q60_all$id))
# Manipulate data into a graphable format
q60_plot <-
q60_all %>%
group_by(response) %>%
summarize(count = n()) %>%
mutate(percent_all = count / sum(count)) %>%
mutate(percent_responded = count / q60_n)
# Plot with percents and response counts
r <-
ggplot(q60_plot, aes(x = reorder(response, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded, 2), count, sep = "***")))
r
# Save graph as PNG, plot data as csv, and all question data including response IDs as csv (save question n and N at end of plot file as "_x.x")
ggsave(filename = 'q60_workplace_cannabis_testing.png', plot = r, device = 'png')
write.csv(q60_plot, 'q60_workplace_cannabis_testing_431.csv', row.names = FALSE)
write.csv(q60_all, 'q60_workplace_cannabis_testing_ids.csv', row.names = FALSE)
# Load libraries
library(tidyverse)
library(ggplot2)
library(stringr)
source("helper.R")
# Pull out all responses for q98 (a single selection question) combine, then determine 'question n' (subsequent q are labeled for convenience, do not respond to survey q#)
q98 <- "What.state.in.the.US.do.you.currently.live.in."
q99 <- "What.US.State.do.you.currently.live.in."
q100 <- "Which.US.state.do.you.currently.live.in."
q101 <- "What.US.state.do.you.currently.live.in."
q98_general <- get_single_selection(data = raw_data_general, q.name = q98)
q98_bask <- get_single_selection(data = raw_data_bask, q.name = q99)
q98_botanist <- get_single_selection(data = raw_data_botanist, q.name = q100)
q98_hr <- get_single_selection(data = raw_data_hr, q.name = q101)
q98_all <- rbind(q98_general, q98_bask, q98_botanist, q98_hr)
ma_ids <- q98_all %>%
filter(response %in% c("Massachusetts"))
state_ma <- length(unique(ma_ids$id))
# Read in raw data from the Veterans surveys. These are the files downloaded from survey monkey saved as a .csv
raw_data_general <- read.csv("data/general.csv", stringsAsFactors = FALSE)
raw_data_botanist <- read.csv("data/botanist.csv", stringsAsFactors = FALSE)
raw_data_bask <- read.csv("data/bask.csv", stringsAsFactors = FALSE)
raw_data_hr <- read.csv("data/hr.csv", stringsAsFactors = FALSE)
# Pull out all responses for q60 (a single selection question) and combine
q60 <- "Are.you.concerned.that.your.workplace.or.other.agency.will.test.you.for.your.cannabis.use."
q60_general <- get_single_selection(data = raw_data_general, q.name = q60)
q60_bask <- get_single_selection(data = raw_data_bask, q.name = q60)
q60_botanist <- get_single_selection(data = raw_data_botanist, q.name = q60)
q60_hr <- get_single_selection(data = raw_data_hr, q.name = q60)
q60_all <- rbind(q60_general, q60_bask, q60_botanist, q60_hr) %>%
inner_join(ma_ids, by = "id")
q60_m_n <- length(unique(q60_all$id))
# Manipulate data into a graphable format
q60_plot <-
q60_all %>%
group_by(response.x) %>%
summarize(count = n()) %>%
mutate(percent_all = count / sum(count)) %>%
mutate(percent_responded = count / q60_m_n)
# Plot with percents and response counts
r <-
ggplot(q60_plot, aes(x = reorder(response.x, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded, 2), count, sep = "***")))
r
# Save graph as PNG, plot data as csv, and all question data including response IDs as csv (save question n and N at end of plot file as "_x.x")
ggsave(filename = 'q60_workplace_cannabis_testing.png', plot = r, device = 'png')
write.csv(q60_plot, 'q60_workplace_cannabis_testing_161.csv', row.names = FALSE)
write.csv(q60_all, 'q60_workplace_cannabis_testing_ids.csv', row.names = FALSE)
# Pull out all responses for q59 (a single selection question) and combine
q59 <- "Are.you.concerned.about.your.workplace.knowing.about.your.cannabis.use."
q59_general <- get_single_selection(data = raw_data_general, q.name = q59)
q59_bask <- get_single_selection(data = raw_data_bask, q.name = q59)
q59_botanist <- get_single_selection(data = raw_data_botanist, q.name = q59)
q59_hr <- get_single_selection(data = raw_data_hr, q.name = q59)
q59_all <- rbind(q59_general, q59_bask, q59_botanist, q59_hr) %>%
inner_join(ma_ids, by = "id")
q59_m_n <- length(unique(q59_all$id))
# Manipulate data into a graphable format
q59_plot <-
q59_all %>%
group_by(response.x) %>%
summarize(count = n()) %>%
mutate(percent_all = count / sum(count)) %>%
mutate(percent_responded = count / q59_m_n)
# Plot with percents and response counts
r <-
ggplot(q59_plot, aes(x = reorder(response.x, count), y = percent_responded)) +
geom_bar(stat = 'identity') +
coord_flip() +
geom_text(aes(label= paste(round(percent_responded, 2), count, sep = "***")))
r
# Save graph as PNG, plot data as csv, and all question data including response IDs as csv (save question n and N at end of plot file as "_x.x")
ggsave(filename = 'q59_workplace_cannabis_knowledge.png', plot = r, device = 'png')
write.csv(q59_plot, 'q59_workplace_cannabis_knowledge_161.csv', row.names = FALSE)
write.csv(q59_all, 'q59_workplace_cannabis_knowledge_ids.csv', row.names = FALSE)
